# ============================================================================
# ESPHome SDL Simulator für LVGL Page Design
# ============================================================================
# Ermöglicht schnelles UI-Testing ohne Hardware-Upload!
# 
# Diese Version inkludiert die ECHTEN Fonts, Colors und Images aus dem Projekt.
# Die Kompilierzeit ist dadurch länger (~30-60 Sekunden), aber das visuelle
# Ergebnis entspricht 1:1 der Hardware.
#
# Usage:
#   esphome run tests/simulator/main.simulator.yaml
#
# ============================================================================

substitutions:
  display_name: displaysimulator
  display_friendly_name: "Display Simulator"
  project_name: tnt_larsn.esphome_display_simulator
  version: "SIM-DEV"
  timezone: "Europe/Berlin"
  display_width: "480"
  display_height: "480"
  navigation_bar_height: "60"
  # Berechnete Höhe für Content-Bereich (display_height - navigation_bar_height)
  content_height: "420"

esphome:
  name: ${display_name}
  friendly_name: ${display_friendly_name}
  includes:
    - ../../src/helper/mdi_icon_map.h
    - ../../src/helper/datetime_helper.h
  on_boot:
    - priority: 400
      then:
        # Bootscreen starten (wie auf echter Hardware)
        - script.execute: update_loading_page
    - priority: -50
      then:
        # Navigation Icons setzen
        - lambda: |-
            static MdiIconHelper helper;
            lv_label_set_text(id(nav_btn_prev_icon), helper.convert_mdi_icon("mdi:chevron-left").c_str());
            lv_label_set_text(id(nav_btn_next_icon), helper.convert_mdi_icon("mdi:chevron-right").c_str());
        # Zeit initial setzen
        - script.execute: update_datetime_display
        # Simuliere HA-Verbindung nach 2 Sekunden (im Simulator)
        - delay: 2s
        - script.execute: on_ha_connected

# Host-Plattform für native Ausführung auf Mac/Linux/Windows
host:

# Logger für Debugging
logger:
  level: DEBUG
  logs:
    lvgl: INFO

# SDL Display - simuliert das 480x480 Display
display:
  - platform: sdl
    id: simulator_display
    dimensions:
      width: ${display_width}
      height: ${display_height}
    window_options:
      always_on_top: true

# SDL Touchscreen - ermöglicht Maus-Interaktion
touchscreen:
  - platform: sdl
    id: simulator_touchscreen

# ============================================================================
# ECHTE Colors aus src/common/colors.yaml
# ============================================================================
color:
  # Primary Colors - Home Assistant Blue
  - id: color_primary
    hex: "3B82F6"
  - id: color_primary_dark
    hex: "1E40AF"
  - id: color_primary_light
    hex: "60A5FA"
  
  # Secondary Colors
  - id: color_secondary
    hex: "F59E0B"
  - id: color_secondary_dark
    hex: "D97706"
  
  # Status Colors
  - id: color_success
    hex: "10B981"
  - id: color_success_dark
    hex: "059669"
  - id: color_warning
    hex: "F59E0B"
  - id: color_error
    hex: "EF4444"
  - id: color_error_dark
    hex: "DC2626"
  - id: color_info
    hex: "06B6D4"
  
  # Neutral Colors
  - id: color_white
    hex: "FFFFFF"
  - id: color_black
    hex: "000000"
  - id: color_gray_50
    hex: "F9FAFB"
  - id: color_gray_100
    hex: "F3F4F6"
  - id: color_gray_200
    hex: "E5E7EB"
  - id: color_gray_300
    hex: "D1D5DB"
  - id: color_gray_400
    hex: "9CA3AF"
  - id: color_gray_500
    hex: "6B7280"
  - id: color_gray_600
    hex: "4B5563"
  - id: color_gray_700
    hex: "374151"
  - id: color_gray_800
    hex: "1F2937"
  - id: color_gray_900
    hex: "111827"
  
  # Background Colors - Light Mode
  - id: color_bg_light
    hex: "FFFFFF"
  - id: color_bg_light_secondary
    hex: "F9FAFB"
  
  # Background Colors - Dark Mode
  - id: color_bg_dark
    hex: "111827"
  - id: color_bg_dark_secondary
    hex: "1F2937"
  - id: color_bg_dark_tertiary
    hex: "374151"
  
  # Text Colors - Light Mode
  - id: color_text_light_primary
    hex: "111827"
  - id: color_text_light_secondary
    hex: "6B7280"
  - id: color_text_light_disabled
    hex: "9CA3AF"
  
  # Text Colors - Dark Mode
  - id: color_text_dark_primary
    hex: "F9FAFB"
  - id: color_text_dark_secondary
    hex: "D1D5DB"
  - id: color_text_dark_disabled
    hex: "9CA3AF"
  
  # Surface Colors
  - id: color_surface
    hex: "FFFFFF"
  - id: color_surface_dark
    hex: "1F2937"

# ============================================================================
# ECHTE Images aus src/common/image.yaml (Pfade angepasst)
# ============================================================================
image:
  - file: '../../src/assets/images/ha_logo.png'
    id: ha_logo
    type: rgb565
    resize: 400x82
    transparency: alpha_channel

  - file: '../../src/assets/images/homeassistant.png'
    id: ha_img
    type: rgb565
    resize: 400x82
    transparency: alpha_channel

  - file: '../../src/assets/images/esphome.png'
    id: esphome_img
    type: rgb565
    resize: 320x95
    transparency: alpha_channel

  - file: '../../src/assets/images/see.png'
    id: see_img
    type: rgb565
    resize: ${display_width}x${display_height}
    transparency: alpha_channel

# ============================================================================
# ECHTE Fonts aus src/common/fonts.yaml (Pfade angepasst)
# ============================================================================
font:
  # Roboto 16 für kleine Labels (Cards)
  - file: "gfonts://Roboto"
    id: roboto16
    size: 16
    bpp: 4
    glyphsets:
      - GF_Latin_Kernel
    glyphs: "äöüÄÖÜß°"
  
  # Roboto 24 für Labels
  - file: "gfonts://Roboto"
    id: roboto24
    size: 24
    bpp: 4
    glyphsets:
      - GF_Latin_Kernel
    glyphs: "äöüÄÖÜß°"
    extras:
      - file: '../../src/assets/fonts/materialdesignicons-webfont.ttf'
        glyphs: [
          "\U000F004B",
          "\U000F006E",
          "\U000F012C",
          "\U000F179B",
          "\U000F0748",
          "\U000F1A1B",
          "\U000F02DC",
          "\U000F02D7",
          "\U000F0A02",
          "\U000F035F",
          "\U000F0156",
          "\U000F0C5F", 
          "\U000f0084",
          "\U000f0091",
          "\U000F050F",
          "\U000F0F55",
        ]
  
  # Roboto 90 für große Uhrzeit
  - file: "gfonts://Roboto"
    id: roboto90
    size: 90
    bpp: 4
    glyphsets:
      - GF_Latin_Kernel
  
  # Weather Icons Font
  - file: "gfonts://Roboto"
    id: weather_icons
    size: 120
    bpp: 4
    extras:
      - file: '../../src/assets/fonts/materialdesignicons-webfont.ttf'
        glyphs: [
          "\U000F0590", # cloudy
          "\U000F0F2F", # cloudyalert
          "\U000F0E6E", # cloudyarrowright
          "\U000F0591", # fog
          "\U000F0AC1", # hail
          "\U000F0F30", # hazy
          "\U000F0898", # hurricane
          "\U000F0593", # lightning
          "\U000F067E", # lightningrainy
          "\U000F0594", # night
          "\U000F0F31", # nightpartlycloudy
          "\U000F0595", # partlycloudy
          "\U000F0F32", # partlylightning
          "\U000F0F33", # partlyrainy
          "\U000F0F34", # partlysnowy
          "\U000F0F35", # partlysnowyrainy
          "\U000F0596", # pouring
          "\U000F0597", # rainy
          "\U000F0598", # snowy
          "\U000F0F36", # snowyheavy
          "\U000F067F", # snowyrainy
          "\U000F0599", # sunny
          "\U000F0F37", # sunnyalert
          "\U000F14E4", # sunnyoff
          "\U000F059A", # sunset
          "\U000F059B", # sunsetdown
          "\U000F059C", # sunsetup
          "\U000F0F38", # tornado
          "\U000F059D", # windy
          "\U000F059E", # windyvariant
          "\U000F01F5", # happyface
          "\U000F02D7", # weather-cloudy
        ]
  
  # MDI Icons 40 für Navigation
  - file: '../../src/assets/fonts/materialdesignicons-webfont.ttf'
    id: mdi_icons_40
    size: 40
    bpp: 4
    glyphs: [
      "\U000F0141", # chevron-left
      "\U000F0142", # chevron-right
      "\U000F004D", # chevron-up
      "\U000F0140", # chevron-down
      "\U000F02DC", # home
      "\U000F0493", # settings
      "\U000F0335", # lightbulb (Quick Action 1)
      "\U000F0238", # fire/heating (Quick Action 2)
      "\U000F111C", # blinds (Quick Action 3)
    ]
  
  # MDI Icons 24 für Header
  - file: '../../src/assets/fonts/materialdesignicons-webfont.ttf'
    id: mdi_icons_24
    size: 24
    bpp: 4
    glyphs: [
      "\U000F0599", # weather-sunny
      "\U000F050F", # thermometer
    ]
  
  # Button Icons Font (64px für große Buttons)
  - file: '../../src/assets/fonts/materialdesignicons-webfont.ttf'
    id: btn_icons_font
    size: 64
    bpp: 4
    glyphs: [
      # Lichter
      "\U000F0335", # lightbulb
      "\U000F0336", # lightbulb-outline
      "\U000F06E8", # lightbulb-on
      "\U000F06E9", # lightbulb-on-outline
      "\U000F06B5", # lamp
      "\U000F08DD", # floor-lamp
      "\U000F095F", # desk-lamp
      "\U000F0769", # ceiling-light
      "\U000F17C7", # ceiling-light-outline
      # Schalter & Steckdosen
      "\U000F0425", # power
      "\U000F06A5", # power-plug
      "\U000F06A6", # power-plug-off
      "\U000F07E7", # power-socket-eu
      "\U000F0521", # toggle-switch
      "\U000F0522", # toggle-switch-off
      # Heizung & Klima
      "\U000F050F", # thermometer
      "\U000F0393", # thermostat
      "\U000F0238", # fire
      "\U000F0438", # radiator
      "\U000F001B", # air-conditioner
      "\U000F0210", # fan
      "\U000F081D", # fan-off
      "\U000F0717", # snowflake
      # Jalousien & Rollos
      "\U000F00AC", # blinds
      "\U000F1011", # blinds-open
      "\U000F111C", # window-shutter
      "\U000F111D", # window-shutter-alert
      "\U000F111E", # window-shutter-open
      # Garage & Türen
      "\U000F06D9", # garage
      "\U000F06DA", # garage-open
      "\U000F081A", # door
      "\U000F081C", # door-open
      "\U000F081B", # door-closed
      # Fenster
      "\U000F05AE", # window-closed
      "\U000F05B1", # window-open
      # Sicherheit
      "\U000F033E", # lock
      "\U000F033F", # lock-open
      "\U000F0498", # shield
      "\U000F068A", # shield-home
      # Sonstiges
      "\U000F02DC", # home
      "\U000F0493", # settings / cog
    ]

# ============================================================================
# Globale Variablen
# ============================================================================
globals:
  # Navigation
  - id: current_page_index
    type: int
    restore_value: no
    initial_value: '0'
  - id: total_pages
    type: int
    restore_value: no
    initial_value: '2'
  # Mock HA Connection Status (startet mit false für Bootscreen)
  - id: ha_connected
    type: bool
    initial_value: 'false'
  # Zeit-Simulation
  - id: sim_hour
    type: int
    initial_value: '14'
  - id: sim_minute
    type: int
    initial_value: '30'
  - id: sim_day
    type: int
    initial_value: '24'
  - id: sim_month
    type: int
    initial_value: '1'
  - id: sim_year
    type: int
    initial_value: '2026'

# ============================================================================
# Mock Home Assistant Text Sensoren
# ============================================================================
text_sensor:
  # Entity 1 - Wohnzimmer Licht
  - platform: template
    id: ha_entity_1_id
    internal: true
    lambda: return std::string("light.wohnzimmer");
  - platform: template
    id: ha_entity_1_icon
    internal: true
    lambda: |-
      static MdiIconHelper helper;
      return helper.convert_mdi_icon("mdi:lightbulb");
  - platform: template
    id: ha_entity_1_state_text
    internal: true
    lambda: return std::string("on");
  - platform: template
    id: ha_entity_1_domain
    internal: true
    lambda: return std::string("light");

  # Entity 2 - Schlafzimmer Licht
  - platform: template
    id: ha_entity_2_id
    internal: true
    lambda: return std::string("light.schlafzimmer");
  - platform: template
    id: ha_entity_2_icon
    internal: true
    lambda: |-
      static MdiIconHelper helper;
      return helper.convert_mdi_icon("mdi:lamp");
  - platform: template
    id: ha_entity_2_state_text
    internal: true
    lambda: return std::string("off");
  - platform: template
    id: ha_entity_2_domain
    internal: true
    lambda: return std::string("light");

  # Entity 3 - Küche Licht
  - platform: template
    id: ha_entity_3_id
    internal: true
    lambda: return std::string("light.kueche");
  - platform: template
    id: ha_entity_3_icon
    internal: true
    lambda: |-
      static MdiIconHelper helper;
      return helper.convert_mdi_icon("mdi:ceiling-light");
  - platform: template
    id: ha_entity_3_state_text
    internal: true
    lambda: return std::string("on");
  - platform: template
    id: ha_entity_3_domain
    internal: true
    lambda: return std::string("light");

  # Entity 4 - Steckdose
  - platform: template
    id: ha_entity_4_id
    internal: true
    lambda: return std::string("switch.steckdose_1");
  - platform: template
    id: ha_entity_4_icon
    internal: true
    lambda: |-
      static MdiIconHelper helper;
      return helper.convert_mdi_icon("mdi:power-socket");
  - platform: template
    id: ha_entity_4_state_text
    internal: true
    lambda: return std::string("off");
  - platform: template
    id: ha_entity_4_domain
    internal: true
    lambda: return std::string("switch");

  # Entity 5 - Ventilator
  - platform: template
    id: ha_entity_5_id
    internal: true
    lambda: return std::string("fan.ventilator");
  - platform: template
    id: ha_entity_5_icon
    internal: true
    lambda: |-
      static MdiIconHelper helper;
      return helper.convert_mdi_icon("mdi:fan");
  - platform: template
    id: ha_entity_5_state_text
    internal: true
    lambda: return std::string("on");
  - platform: template
    id: ha_entity_5_domain
    internal: true
    lambda: return std::string("fan");

  # Entity 6 - Rollladen
  - platform: template
    id: ha_entity_6_id
    internal: true
    lambda: return std::string("cover.rollladen");
  - platform: template
    id: ha_entity_6_icon
    internal: true
    lambda: |-
      static MdiIconHelper helper;
      return helper.convert_mdi_icon("mdi:window-shutter");
  - platform: template
    id: ha_entity_6_state_text
    internal: true
    lambda: return std::string("open");
  - platform: template
    id: ha_entity_6_domain
    internal: true
    lambda: return std::string("cover");

  # Entity 7 - Wetter (für Home Page)
  - platform: template
    id: ha_entity_7_id
    internal: true
    lambda: return std::string("weather.zuhause");
  - platform: template
    id: ha_entity_7_icon
    internal: true
    lambda: return std::string("\U000F0599");  # sunny icon
  - platform: template
    id: ha_entity_7_state_text
    internal: true
    lambda: return std::string("sunny");
  - platform: template
    id: ha_entity_7_domain
    internal: true
    lambda: return std::string("weather");

# ============================================================================
# Scripts
# ============================================================================
script:
  # ========================================================================
  # BOOTSCREEN Scripts (1:1 wie src/pages/boot.yaml)
  # ========================================================================
  - id: update_loading_page
    then:
      - lvgl.widget.hide: navigation_bar
      - lvgl.label.update:
          id: boot_synchronization_label
          text: "Synchronisiere..."
      - lvgl.label.update:
          id: boot_homeassistant_label
          text: "Verbinde Home Assistant..."

  - id: check_boot_status
    then:
      - lambda: |-
          if (id(ha_connected)) {
            lv_obj_add_flag(id(boot_homeassistant), LV_OBJ_FLAG_HIDDEN);
            lv_obj_clear_flag(id(boot_synchronization), LV_OBJ_FLAG_HIDDEN);
            id(start_sync_animation).execute();
          }

  - id: start_sync_animation
    then:
      - delay: 1s
      - lvgl.bar.update:
          id: boot_synchronization_bar
          value: 25

      - delay: 1s
      - lvgl.bar.update:
          id: boot_synchronization_bar
          value: 50

      - delay: 1s
      - lvgl.bar.update:
          id: boot_synchronization_bar
          value: 75

      - delay: 1s
      - lvgl.bar.update:
          id: boot_synchronization_bar
          value: 100

      - delay: 1s
      - lvgl.widget.hide: loading_page
      - lambda: 'id(current_page_index) = 0;'
      - lvgl.page.show:
          id: home_page
      - lvgl.widget.show: navigation_bar

  - id: on_ha_connected
    then:
      - lambda: |-
          if (!id(ha_connected)) {
            id(ha_connected) = true;
            lv_label_set_text(id(boot_homeassistant_label), "Home Assistant Connected!");
            lv_obj_add_flag(id(boot_homeassistant_spinner), LV_OBJ_FLAG_HIDDEN);
            id(check_boot_status).execute();
          }

  # ========================================================================
  # Zeit-Display Update (ohne echte sntp_time)
  # ========================================================================
  - id: update_datetime_display
    mode: single
    then:
      - lvgl.label.update:
          id: display_time
          text: !lambda |-
            char buf[16];
            snprintf(buf, sizeof(buf), "%02d:%02d", id(sim_hour), id(sim_minute));
            return std::string(buf);
      - lvgl.label.update:
          id: display_date
          text: !lambda |-
            const char* months[] = {"", "Januar", "Februar", "März", "April", "Mai", 
                                     "Juni", "Juli", "August", "September", "Oktober", 
                                     "November", "Dezember"};
            char buf[32];
            snprintf(buf, sizeof(buf), "%d. %s %d", id(sim_day), months[id(sim_month)], id(sim_year));
            return std::string(buf);

  # Navigation Scripts
  - id: navigate_prev
    then:
      - lambda: |-
          int current = id(current_page_index);
          int total = id(total_pages);
          current = (current - 1 + total) % total;
          id(current_page_index) = current;
      - script.execute: show_current_page

  - id: navigate_next
    then:
      - lambda: |-
          int current = id(current_page_index);
          int total = id(total_pages);
          current = (current + 1) % total;
          id(current_page_index) = current;
      - script.execute: show_current_page

  - id: show_current_page
    then:
      - if:
          condition:
            lambda: 'return id(current_page_index) == 0;'
          then:
            - lvgl.page.show: home_page
          else:
            - if:
                condition:
                  lambda: 'return id(current_page_index) == 1;'
                then:
                  - lvgl.page.show: switches_page
                else:
                  - lambda: 'id(current_page_index) = 0;'
                  - lvgl.page.show: home_page

  - id: show_navigation
    then:
      - lvgl.widget.show: navigation_bar

  - id: hide_navigation
    then:
      - lvgl.widget.hide: navigation_bar

# Zeit-Simulation: Jede Minute erhöhen
interval:
  - interval: 60s
    then:
      - lambda: |-
          id(sim_minute)++;
          if (id(sim_minute) >= 60) {
            id(sim_minute) = 0;
            id(sim_hour)++;
            if (id(sim_hour) >= 24) {
              id(sim_hour) = 0;
              id(sim_day)++;
              if (id(sim_day) > 28) {
                id(sim_day) = 1;
                id(sim_month)++;
                if (id(sim_month) > 12) {
                  id(sim_month) = 1;
                  id(sim_year)++;
                }
              }
            }
          }
      - script.execute: update_datetime_display

# ============================================================================
# LVGL Konfiguration
# ============================================================================
lvgl:
  displays:
    - simulator_display
  touchscreens:
    - simulator_touchscreen
  
  # Idle-Handling deaktiviert für Simulator
  on_idle:
    timeout: 0ms
    then: []

  # ============================================================================
  # MODERN GLASSMORPHISM THEME - 2026 Edition
  # ============================================================================
  # Design-Prinzipien:
  # - 8dp Baseline Grid für konsistentes Spacing
  # - Glassmorphism-Effekte mit semi-transparenten Hintergründen
  # - Weiche Schatten für natürliche Tiefe
  # - Großzügiges Whitespace
  # - Touch-freundliche Buttons (min 48dp)
  # - Smooth Transitions für alle Interaktionen
  # ============================================================================
  theme:
    # Basis-Label Styling
    label:
      text_font: roboto24
      text_color: color_text_dark_primary
    
    # Modern Button mit Glassmorphism
    button:
      radius: 16
      bg_color: color_gray_800
      bg_opa: 70%
      border_color: color_gray_600
      border_width: 1
      border_opa: 30%
      text_color: color_text_dark_primary
      shadow_width: 12
      shadow_ofs_x: 0
      shadow_ofs_y: 4
      shadow_color: color_black
      shadow_opa: 40%
      pad_all: 16
      # Transition für smooth Hover/Press
      pressed:
        bg_color: color_gray_700
        bg_opa: 90%
        shadow_width: 8
        shadow_ofs_y: 2
        border_color: color_primary
        border_opa: 60%
      checked:
        bg_color: color_primary_dark
        bg_opa: 85%
        border_color: color_primary
        border_opa: 80%
        text_color: color_white
        shadow_width: 16
        shadow_color: color_primary_dark
        shadow_opa: 50%
    
    # Button Matrix - Grid-Style
    buttonmatrix:
      bg_opa: TRANSP
      border_width: 0
      text_color: color_white
      pad_all: 8
      items:
        radius: 12
        bg_color: color_gray_800
        bg_opa: 60%
        border_color: color_gray_600
        border_width: 1
        border_opa: 25%
        text_color: color_white
        pressed:
          bg_color: color_gray_700
          bg_opa: 80%
          border_color: color_primary
        checked:
          bg_color: color_primary_dark
          bg_opa: 75%
          text_color: color_white
          border_color: color_primary
    
    # Modern Switch
    switch:
      radius: 999
      border_width: 0
      outline_opa: TRANSP
      shadow_width: 8
      shadow_color: color_black
      shadow_opa: 30%
      bg_color: color_gray_600
      bg_opa: COVER
      checked:
        bg_color: color_primary
        bg_opa: COVER
        border_width: 0
        shadow_color: color_primary
        shadow_opa: 40%
      indicator:
        bg_opa: TRANSP
        border_width: 0
        checked:
          bg_color: color_primary
          bg_opa: COVER
      knob:
        radius: 999
        bg_color: color_white
        bg_opa: COVER
        border_width: 0
        shadow_width: 4
        shadow_color: color_black
        shadow_opa: 30%
        checked:
          bg_color: color_white
    
    # Elegant Slider
    slider:
      radius: 8
      border_width: 0
      bg_color: color_gray_700
      bg_opa: 50%
      indicator:
        radius: 8
        bg_color: color_primary
        bg_grad_color: color_primary_light
        bg_grad_dir: HOR
        bg_opa: COVER
      knob:
        radius: 999
        bg_color: color_white
        bg_opa: COVER
        border_width: 0
        shadow_width: 8
        shadow_color: color_black
        shadow_opa: 40%

  # ============================================================================
  # MODERN STYLE DEFINITIONS - Glassmorphism & Card System
  # ============================================================================
  style_definitions:
    # Glass Card - Hauptcontainer für Content
    - id: glass_card
      radius: 24
      bg_color: color_gray_800
      bg_opa: 65%
      border_color: color_gray_500
      border_width: 1
      border_opa: 20%
      shadow_width: 20
      shadow_ofs_x: 0
      shadow_ofs_y: 8
      shadow_color: color_black
      shadow_opa: 35%
      pad_all: 24
    
    # Glass Card Small - Für kleinere Elemente
    - id: glass_card_small
      radius: 16
      bg_color: color_gray_800
      bg_opa: 55%
      border_color: color_gray_500
      border_width: 1
      border_opa: 15%
      shadow_width: 12
      shadow_ofs_y: 4
      shadow_color: color_black
      shadow_opa: 25%
      pad_all: 16
    
    # Navigation Bar Style - Modern Floating
    - id: nav_bar_modern
      radius: 20
      bg_color: color_gray_900
      bg_opa: 80%
      border_color: color_gray_600
      border_width: 1
      border_opa: 30%
      shadow_width: 16
      shadow_ofs_y: -4
      shadow_color: color_black
      shadow_opa: 40%
      pad_all: 8
      pad_left: 16
      pad_right: 16
    
    # Header/Footer - Dezent
    - id: header_footer
      bg_color: color_gray_800
      bg_opa: 70%
      radius: 0
      pad_all: 8
      pad_row: 0
      pad_column: 4
      border_width: 0
      width: 100%
      height: 48
    
    # Button im Header/Footer
    - id: header_footer_btn
      bg_color: color_gray_700
      bg_opa: 50%
      radius: 12
      border_width: 0
      pad_all: 8
      height: 40
      width: 80
    
    # Status-Karte für Fehler
    - id: status_error
      radius: 12
      border_width: 1
      border_opa: 40%
      border_color: color_error
      bg_color: color_error
      bg_opa: 15%
    
    # Status-Karte für Erfolg
    - id: status_success
      radius: 12
      border_width: 1
      border_opa: 40%
      border_color: color_success
      bg_color: color_success
      bg_opa: 15%
    
    # Primary Accent Button
    - id: btn_primary
      radius: 14
      bg_color: color_primary
      bg_opa: 90%
      border_width: 0
      shadow_width: 12
      shadow_color: color_primary_dark
      shadow_opa: 50%
      text_color: color_white
    
    # Icon Button - Rund
    - id: btn_icon_round
      radius: 999
      width: 56
      height: 56
      bg_color: color_gray_800
      bg_opa: 60%
      border_color: color_gray_600
      border_width: 1
      border_opa: 25%
      shadow_width: 8
      shadow_ofs_y: 2
      shadow_color: color_black
      shadow_opa: 30%
    
    # Divider Line
    - id: divider
      height: 1
      bg_color: color_gray_600
      bg_opa: 30%
      radius: 0
      border_width: 0
    
    # Large Time Display
    - id: time_display
      text_color: color_white
      text_font: roboto90
    
    # Subtitle Text
    - id: subtitle_text
      text_color: color_gray_400
      text_font: roboto24

  # ============================================================================
  # ANIMATIONS - Smooth Transitions für modernes UX
  # ============================================================================
  # ESPHome LVGL unterstützt Animationen über:
  # 1. Style Transitions (CSS-like)
  # 2. LVGL Animation API via Lambda
  # ============================================================================
  
  # Top Layer: Loading Page (Bootscreen) + Navigation Bar
  top_layer:
    widgets:
      # ========================================================================
      # BOOTSCREEN - Modern Gradient Design
      # ========================================================================
      - obj:
          id: loading_page
          bg_color: color_bg_dark
          bg_opa: COVER
          shadow_opa: transp
          width: ${display_width}
          height: ${display_height}
          outline_width: 0
          border_width: 0
          radius: 0
          widgets:
            # Logo mit mehr Padding nach oben
            - image:
                y: 60
                align: top_mid
                src: ha_img
            
            # Status Container - Zentriert
            - obj:
                id: boot_homeassistant
                y: 200
                width: 340
                height: 140
                pad_all: 24
                align: top_mid
                radius: 24
                bg_color: color_gray_800
                bg_opa: 50%
                border_color: color_gray_600
                border_width: 1
                border_opa: 20%
                shadow_width: 20
                shadow_ofs_y: 8
                shadow_color: color_black
                shadow_opa: 30%
                scrollbar_mode: "OFF"
                layout:
                  type: GRID
                  grid_columns: [FR(1)]
                  grid_rows: [SIZE_CONTENT, 16, SIZE_CONTENT]
                widgets:
                  - label:
                      id: boot_homeassistant_label
                      grid_cell_column_pos: 0
                      grid_cell_row_pos: 0
                      grid_cell_x_align: CENTER
                      grid_cell_y_align: CENTER
                      text_font: roboto24
                      text_color: color_text_dark_primary
                      text: "Verbinde..."
                  - spinner:
                      id: boot_homeassistant_spinner
                      grid_cell_column_pos: 0
                      grid_cell_row_pos: 2
                      grid_cell_x_align: CENTER
                      grid_cell_y_align: CENTER
                      width: 48
                      height: 48
                      spin_time: 1500ms
                      arc_length: 90deg
                      arc_width: 4
                      arc_color: color_gray_700
                      indicator:
                        arc_color: color_primary
                        arc_width: 4
            
            # Sync Container
            - obj:
                id: boot_synchronization
                y: 200
                width: 340
                height: 120
                pad_all: 24
                align: top_mid
                radius: 24
                bg_color: color_gray_800
                bg_opa: 50%
                border_color: color_gray_600
                border_width: 1
                border_opa: 20%
                shadow_width: 20
                shadow_ofs_y: 8
                shadow_color: color_black
                shadow_opa: 30%
                hidden: true
                scrollbar_mode: "OFF"
                layout:
                  type: GRID
                  grid_columns: [FR(1)]
                  grid_rows: [SIZE_CONTENT, 24, SIZE_CONTENT]
                widgets:
                  - label:
                      id: boot_synchronization_label
                      grid_cell_column_pos: 0
                      grid_cell_row_pos: 0
                      grid_cell_x_align: CENTER
                      grid_cell_y_align: CENTER
                      text_font: roboto24
                      text_color: color_text_dark_primary
                      text: "Synchronisiere..."
                  - bar:
                      id: boot_synchronization_bar
                      grid_cell_column_pos: 0
                      grid_cell_row_pos: 2
                      grid_cell_x_align: CENTER
                      grid_cell_y_align: CENTER
                      width: 280
                      height: 8
                      value: 0
                      min_value: 0
                      max_value: 100
                      animated: true
                      radius: 4
                      bg_color: color_gray_700
                      bg_opa: 60%
                      indicator:
                        radius: 4
                        bg_color: color_primary
                        bg_grad_color: color_primary_light
                        bg_grad_dir: HOR

      # ========================================================================
      # NAVIGATION BAR - Modern Floating Style
      # ========================================================================
      - obj:
          id: navigation_bar
          align: BOTTOM_MID
          y: -12
          width: 460
          height: 56
          styles: nav_bar_modern
          hidden: true
          scrollbar_mode: "OFF"
          layout:
            type: GRID
            grid_columns: [FR(1), FR(2), FR(1)]
            grid_rows: [FR(1)]
            pad_row: 0
            pad_column: 8
          widgets:
            # Zurück-Button
            - button:
                id: nav_btn_prev
                grid_cell_column_pos: 0
                grid_cell_row_pos: 0
                grid_cell_x_align: CENTER
                grid_cell_y_align: CENTER
                width: 48
                height: 48
                radius: 14
                bg_color: color_gray_800
                bg_opa: 60%
                border_opa: TRANSP
                shadow_opa: TRANSP
                on_click:
                  then:
                    - script.execute: navigate_prev
                widgets:
                  - label:
                      id: nav_btn_prev_icon
                      align: CENTER
                      text_font: mdi_icons_40
                      text: "\U000F0141"
                      text_color: color_gray_300

            # Page Indicator (Mitte)
            - obj:
                grid_cell_column_pos: 1
                grid_cell_row_pos: 0
                grid_cell_x_align: CENTER
                grid_cell_y_align: CENTER
                width: 80
                height: 8
                bg_opa: TRANSP
                border_opa: TRANSP
                layout:
                  type: GRID
                  grid_columns: [FR(1), FR(1)]
                  grid_rows: [FR(1)]
                  pad_column: 8
                widgets:
                  # Dot 1
                  - obj:
                      id: page_dot_1
                      grid_cell_column_pos: 0
                      grid_cell_row_pos: 0
                      grid_cell_x_align: CENTER
                      grid_cell_y_align: CENTER
                      width: 32
                      height: 6
                      radius: 3
                      bg_color: color_primary
                      bg_opa: COVER
                      border_opa: TRANSP
                  # Dot 2
                  - obj:
                      id: page_dot_2
                      grid_cell_column_pos: 1
                      grid_cell_row_pos: 0
                      grid_cell_x_align: CENTER
                      grid_cell_y_align: CENTER
                      width: 8
                      height: 6
                      radius: 3
                      bg_color: color_gray_600
                      bg_opa: COVER
                      border_opa: TRANSP

            # Vor-Button
            - button:
                id: nav_btn_next
                grid_cell_column_pos: 2
                grid_cell_row_pos: 0
                grid_cell_x_align: CENTER
                grid_cell_y_align: CENTER
                width: 48
                height: 48
                radius: 14
                bg_color: color_gray_800
                bg_opa: 60%
                border_opa: TRANSP
                shadow_opa: TRANSP
                on_click:
                  then:
                    - script.execute: navigate_next
                widgets:
                  - label:
                      id: nav_btn_next_icon
                      align: CENTER
                      text_font: mdi_icons_40
                      text: "\U000F0142"
                      text_color: color_gray_300

  # Seiten
  pages:
    # ========================================================================
    # HOME PAGE - Modern Hero Layout
    # ========================================================================
    # Design-Konzept: Große Uhrzeit als Hero, Wetter als Accent,
    # Datum als Subtitle - klare visuelle Hierarchie
    # ========================================================================
    - id: home_page
      bg_color: color_bg_dark
      widgets:
        # Hintergrundbild
        - image:
            align: CENTER
            src: see_img
        
        # Hauptcontainer mit Grid Layout
        - obj:
            id: home_main_container
            layout:
              type: GRID
              grid_columns: [FR(1)]
              grid_rows: [56, FR(1)]
            width: 100%
            height: ${content_height}
            pad_all: 0
            bg_opa: TRANSP
            border_opa: TRANSP
            widgets:
              
              # ============================================================
              # TOP BAR - Wetter & Status (mit Glassmorphism Backdrop)
              # ============================================================
              - obj:
                  grid_cell_column_pos: 0
                  grid_cell_row_pos: 0
                  grid_cell_x_align: STRETCH
                  grid_cell_y_align: START
                  width: 100%
                  height: 56
                  pad_left: 16
                  pad_right: 16
                  pad_top: 12
                  bg_color: color_bg_dark
                  bg_opa: 70%
                  border_opa: TRANSP
                  scrollbar_mode: "OFF"
                  layout:
                    type: GRID
                    grid_columns: [FR(1), FR(1)]
                    grid_rows: [FR(1)]
                  widgets:
                    # Wetter Info (links)
                    - obj:
                        grid_cell_column_pos: 0
                        grid_cell_row_pos: 0
                        grid_cell_x_align: START
                        grid_cell_y_align: CENTER
                        width: SIZE_CONTENT
                        height: SIZE_CONTENT
                        bg_opa: TRANSP
                        border_opa: TRANSP
                        layout:
                          type: GRID
                          grid_columns: [36, SIZE_CONTENT]
                          grid_rows: [FR(1)]
                          pad_column: 10
                        widgets:
                          - label:
                              grid_cell_column_pos: 0
                              grid_cell_row_pos: 0
                              grid_cell_x_align: CENTER
                              grid_cell_y_align: CENTER
                              id: homeassistant_btn_7_icon
                              text: "\U000F0599"
                              text_color: color_secondary
                              text_font: mdi_icons_24
                          - label:
                              grid_cell_column_pos: 1
                              grid_cell_row_pos: 0
                              grid_cell_x_align: START
                              grid_cell_y_align: CENTER
                              id: homeassistant_btn_7_label
                              text: "22°C  Sonnig"
                              text_font: roboto24
                              text_color: color_white
                    
                    # Innentemperatur (rechts)
                    - obj:
                        grid_cell_column_pos: 1
                        grid_cell_row_pos: 0
                        grid_cell_x_align: END
                        grid_cell_y_align: CENTER
                        width: SIZE_CONTENT
                        height: SIZE_CONTENT
                        bg_opa: TRANSP
                        border_opa: TRANSP
                        layout:
                          type: GRID
                          grid_columns: [SIZE_CONTENT, SIZE_CONTENT]
                          grid_rows: [FR(1)]
                          pad_column: 8
                        widgets:
                          - label:
                              grid_cell_column_pos: 0
                              grid_cell_row_pos: 0
                              grid_cell_x_align: END
                              grid_cell_y_align: CENTER
                              text: "\U000F050F"
                              text_color: color_primary_light
                              text_font: mdi_icons_24
                          - label:
                              grid_cell_column_pos: 1
                              grid_cell_row_pos: 0
                              grid_cell_x_align: START
                              grid_cell_y_align: CENTER
                              id: display_house_temp
                              text: "21.5°C"
                              text_font: roboto24
                              text_color: color_white

              # ============================================================
              # HERO SECTION - Uhrzeit & Datum (oberer Bereich)
              # Spacing-Prinzip: Zusammengehörige Elemente haben engen Abstand
              # ============================================================
              - obj:
                  grid_cell_column_pos: 0
                  grid_cell_row_pos: 1
                  grid_cell_x_align: CENTER
                  grid_cell_y_align: START
                  width: SIZE_CONTENT
                  height: SIZE_CONTENT
                  bg_opa: TRANSP
                  border_opa: TRANSP
                  scrollbar_mode: "OFF"
                  pad_top: 24
                  layout:
                    type: GRID
                    grid_columns: [FR(1)]
                    grid_rows: [90, SIZE_CONTENT]
                  widgets:
                    # Große Uhrzeit - HERO Element
                    - label:
                        grid_cell_column_pos: 0
                        grid_cell_row_pos: 0
                        grid_cell_x_align: CENTER
                        grid_cell_y_align: CENTER
                        id: display_time
                        text: "14:30"
                        text_font: roboto90
                        text_color: color_gray_800
                    
                    # Datum - Subheading (direkt unter Uhrzeit)
                    - label:
                        grid_cell_column_pos: 0
                        grid_cell_row_pos: 1
                        grid_cell_x_align: CENTER
                        grid_cell_y_align: START
                        y: -12
                        id: display_date
                        text: "Freitag, 24. Januar 2026"
                        text_font: roboto24
                        text_color: color_gray_700

    # ========================================================================
    # SWITCHES PAGE - Modern Card Grid Layout
    # ========================================================================
    # Design-Konzept: Glassmorphism Cards mit klarer Hierarchie
    # Icon zentriert, Label darunter, Status-Anzeige integriert
    # ========================================================================
    - id: switches_page
      bg_color: color_bg_dark
      widgets:
        # Hintergrundbild
        - image:
            align: CENTER
            src: see_img
        
        # Page Title mit Backdrop
        - obj:
            align: TOP_MID
            y: 12
            width: SIZE_CONTENT
            height: 40
            pad_left: 20
            pad_right: 20
            radius: 20
            bg_color: color_bg_dark
            bg_opa: 70%
            border_opa: TRANSP
            widgets:
              - label:
                  align: CENTER
                  text: "Geräte"
                  text_font: roboto24
                  text_color: color_white
        
        # Hauptcontainer mit 2x3 Grid
        - obj:
            layout:
              type: GRID
              grid_columns: [FR(1), FR(1), FR(1)]
              grid_rows: [FR(1), FR(1)]
              pad_row: 16
              pad_column: 16
            width: 100%
            height: 340
            y: 48
            pad_all: 20
            pad_top: 24
            bg_opa: TRANSP
            border_opa: TRANSP
            widgets:
              # ============================================================
              # ROW 1
              # ============================================================
              
              # Card 1 - Wohnzimmer
              - button:
                  id: homeassistant_btn_1
                  checkable: true
                  grid_cell_column_pos: 0
                  grid_cell_row_pos: 0
                  grid_cell_x_align: STRETCH
                  grid_cell_y_align: STRETCH
                  radius: 20
                  bg_color: color_gray_800
                  bg_opa: 55%
                  border_color: color_gray_600
                  border_width: 1
                  border_opa: 20%
                  shadow_width: 16
                  shadow_ofs_y: 6
                  shadow_color: color_black
                  shadow_opa: 35%
                  layout:
                    type: GRID
                    grid_columns: [FR(1)]
                    grid_rows: [FR(3), FR(1)]
                  widgets:
                    - label:
                        id: homeassistant_btn_1_icon
                        grid_cell_column_pos: 0
                        grid_cell_row_pos: 0
                        grid_cell_x_align: CENTER
                        grid_cell_y_align: CENTER
                        text_font: btn_icons_font
                        text: "\U000F0335"
                        text_color: color_white
                    - label:
                        id: homeassistant_btn_1_label
                        grid_cell_column_pos: 0
                        grid_cell_row_pos: 1
                        grid_cell_x_align: CENTER
                        grid_cell_y_align: CENTER
                        text: "Wohnzimmer"
                        text_font: roboto16
                        text_color: color_gray_200

              # Card 2 - Küche
              - button:
                  id: homeassistant_btn_3
                  checkable: true
                  grid_cell_column_pos: 1
                  grid_cell_row_pos: 0
                  grid_cell_x_align: STRETCH
                  grid_cell_y_align: STRETCH
                  radius: 20
                  bg_color: color_gray_800
                  bg_opa: 55%
                  border_color: color_gray_600
                  border_width: 1
                  border_opa: 20%
                  shadow_width: 16
                  shadow_ofs_y: 6
                  shadow_color: color_black
                  shadow_opa: 35%
                  layout:
                    type: GRID
                    grid_columns: [FR(1)]
                    grid_rows: [FR(3), FR(1)]
                  widgets:
                    - label:
                        id: homeassistant_btn_3_icon
                        grid_cell_column_pos: 0
                        grid_cell_row_pos: 0
                        grid_cell_x_align: CENTER
                        grid_cell_y_align: CENTER
                        text_font: btn_icons_font
                        text: "\U000F0769"
                        text_color: color_white
                    - label:
                        id: homeassistant_btn_3_label
                        grid_cell_column_pos: 0
                        grid_cell_row_pos: 1
                        grid_cell_x_align: CENTER
                        grid_cell_y_align: CENTER
                        text: "Küche"
                        text_font: roboto16
                        text_color: color_gray_200

              # Card 3 - Ventilator
              - button:
                  id: homeassistant_btn_5
                  checkable: true
                  grid_cell_column_pos: 2
                  grid_cell_row_pos: 0
                  grid_cell_x_align: STRETCH
                  grid_cell_y_align: STRETCH
                  radius: 20
                  bg_color: color_gray_800
                  bg_opa: 55%
                  border_color: color_gray_600
                  border_width: 1
                  border_opa: 20%
                  shadow_width: 16
                  shadow_ofs_y: 6
                  shadow_color: color_black
                  shadow_opa: 35%
                  layout:
                    type: GRID
                    grid_columns: [FR(1)]
                    grid_rows: [FR(3), FR(1)]
                  widgets:
                    - label:
                        id: homeassistant_btn_5_icon
                        grid_cell_column_pos: 0
                        grid_cell_row_pos: 0
                        grid_cell_x_align: CENTER
                        grid_cell_y_align: CENTER
                        text_font: btn_icons_font
                        text: "\U000F0210"
                        text_color: color_white
                    - label:
                        id: homeassistant_btn_5_label
                        grid_cell_column_pos: 0
                        grid_cell_row_pos: 1
                        grid_cell_x_align: CENTER
                        grid_cell_y_align: CENTER
                        text: "Ventilator"
                        text_font: roboto16
                        text_color: color_gray_200

              # ============================================================
              # ROW 2
              # ============================================================
              
              # Card 4 - Schlafzimmer
              - button:
                  id: homeassistant_btn_2
                  checkable: true
                  grid_cell_column_pos: 0
                  grid_cell_row_pos: 1
                  grid_cell_x_align: STRETCH
                  grid_cell_y_align: STRETCH
                  radius: 20
                  bg_color: color_gray_800
                  bg_opa: 55%
                  border_color: color_gray_600
                  border_width: 1
                  border_opa: 20%
                  shadow_width: 16
                  shadow_ofs_y: 6
                  shadow_color: color_black
                  shadow_opa: 35%
                  layout:
                    type: GRID
                    grid_columns: [FR(1)]
                    grid_rows: [FR(3), FR(1)]
                  widgets:
                    - label:
                        id: homeassistant_btn_2_icon
                        grid_cell_column_pos: 0
                        grid_cell_row_pos: 0
                        grid_cell_x_align: CENTER
                        grid_cell_y_align: CENTER
                        text_font: btn_icons_font
                        text: "\U000F06B5"
                        text_color: color_white
                    - label:
                        id: homeassistant_btn_2_label
                        grid_cell_column_pos: 0
                        grid_cell_row_pos: 1
                        grid_cell_x_align: CENTER
                        grid_cell_y_align: CENTER
                        text: "Schlafzimmer"
                        text_font: roboto16
                        text_color: color_gray_200

              # Card 5 - Steckdose
              - button:
                  id: homeassistant_btn_4
                  checkable: true
                  grid_cell_column_pos: 1
                  grid_cell_row_pos: 1
                  grid_cell_x_align: STRETCH
                  grid_cell_y_align: STRETCH
                  radius: 20
                  bg_color: color_gray_800
                  bg_opa: 55%
                  border_color: color_gray_600
                  border_width: 1
                  border_opa: 20%
                  shadow_width: 16
                  shadow_ofs_y: 6
                  shadow_color: color_black
                  shadow_opa: 35%
                  layout:
                    type: GRID
                    grid_columns: [FR(1)]
                    grid_rows: [FR(3), FR(1)]
                  widgets:
                    - label:
                        id: homeassistant_btn_4_icon
                        grid_cell_column_pos: 0
                        grid_cell_row_pos: 0
                        grid_cell_x_align: CENTER
                        grid_cell_y_align: CENTER
                        text_font: btn_icons_font
                        text: "\U000F07E7"
                        text_color: color_white
                    - label:
                        id: homeassistant_btn_4_label
                        grid_cell_column_pos: 0
                        grid_cell_row_pos: 1
                        grid_cell_x_align: CENTER
                        grid_cell_y_align: CENTER
                        text: "Steckdose"
                        text_font: roboto16
                        text_color: color_gray_200

              # Card 6 - Rollladen
              - button:
                  id: homeassistant_btn_6
                  checkable: true
                  grid_cell_column_pos: 2
                  grid_cell_row_pos: 1
                  grid_cell_x_align: STRETCH
                  grid_cell_y_align: STRETCH
                  radius: 20
                  bg_color: color_gray_800
                  bg_opa: 55%
                  border_color: color_gray_600
                  border_width: 1
                  border_opa: 20%
                  shadow_width: 16
                  shadow_ofs_y: 6
                  shadow_color: color_black
                  shadow_opa: 35%
                  layout:
                    type: GRID
                    grid_columns: [FR(1)]
                    grid_rows: [FR(3), FR(1)]
                  widgets:
                    - label:
                        id: homeassistant_btn_6_icon
                        grid_cell_column_pos: 0
                        grid_cell_row_pos: 0
                        grid_cell_x_align: CENTER
                        grid_cell_y_align: CENTER
                        text_font: btn_icons_font
                        text: "\U000F111C"
                        text_color: color_white
                    - label:
                        id: homeassistant_btn_6_label
                        grid_cell_column_pos: 0
                        grid_cell_row_pos: 1
                        grid_cell_x_align: CENTER
                        grid_cell_y_align: CENTER
                        text: "Rollladen"
                        text_font: roboto16
                        text_color: color_gray_200
